---
layout: post
title: treegrid如果传入标签会显示空白
categories: jQuery
description: treegrid如果传入标签会显示空白
keywords: treegrid, 特殊字符, 标签
---

treegrid如果传入标签会显示空白

## 问题
如图，后台传入的参数为一个标签时
![](/assets/images/posts/jquery/esHSCJv.png)
tree会将其当成标签嵌入页面，由于当成标签，在页面中是看不见的
![](/assets/images/posts/jquery/aKB3PZC.png)
## 解决
判断value，如果含有标签(<>)或者特殊字符(主要针对标签，其余特殊字符一般不会引起这个问题，但为了严谨都处理一下)，将其作为input的value显示，并将input的边框等全部去掉
```
let columns = [
    {
        field: 'name',
        title: '名称',
        formatter: formatName,
        width: '25%',
        align: 'left'
    }
]
function formatName (value,row,index) {
    let reg = new RegExp("[`~!@#$^&*()=|{}':;',\\[\\].<>/?~！@#￥……&*（）——|{}【】‘；：”“’。，、？%+_]");
    if (reg.test(value)) { // 如果包含特殊字符
        return  '<input value="'+value+'" readonly style="border:none;background:none"/>';
    } else {
        return  value;
    }
}
```
## 问题
![](/assets/images/posts/jquery/tIZbMjR.png)
虽然已经将特殊字符都添加到value中，但这个特殊字符太特殊了，既有<>又有""，浏览器最后解析为input的value="<el-col :span="，而且后面有>，浏览器认为input结束了，readonly style="border:none;background:none"/>都不在input中
## 解决
使用textarea标签
```
function formatName (value,row,index) {
    let reg = new RegExp("[`~!@#$^&*()=|{}':;',\\[\\].<>/?~！@#￥……&*（）——|{}【】‘；：”“’。，、？%+_]");
    if (reg.test(value)) {// 如果包含特殊字符
        return  `<textarea readonly style="width:100%; border:none; background:none; outline:none;">${value}</textarea>`;
    } else {
        return  value;
    }
}
```

## 问题

当文本太长时，textarea会换行

## 解决

使用xmp标签(已在HTML4.0被移除，但各大浏览器仍支持)

```
function formatName (value,row,index) {
    let reg = new RegExp("[`~!@#$^&*()=|{}':;',\\[\\].<>/?~！@#￥……&*（）——|{}【】‘；：”“’。，、？%+_]");
    if (reg.test(value)) {// 如果包含特殊字符
        return `<xmp style="margin:0; width:400px; overflow: hidden; text-overflow:ellipsis; white-space: nowrap;">${value}</xmp>`
    } else {
        return  value;
    }
}
```
xmp默认white-space: pre; margin: 1em 0px; 需要修改一下。width根据实际情况而定